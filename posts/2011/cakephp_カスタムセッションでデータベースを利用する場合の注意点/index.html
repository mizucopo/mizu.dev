<!doctype html><html lang=ja-jp><head><title>CakePHP カスタムセッションでデータベースを利用する場合の注意点 | みず ねっとわーくさーびす</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="セッション情報の格納先をデータベースにした場合で、かつ、カスタムセッションを利用している場合の注意点。"><meta name=keywords content="開発,CakePHP"><meta name=msapplication-TileColor content="#b91d47"><meta name=theme-color content="#ffffff"><link rel=canonical href=https://mizu.dev/posts/2011/cakephp_%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%A0%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A7%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%82%92%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#007aa6><meta name=theme-color content="#ffffff"><meta property="og:title" content="CakePHP カスタムセッションでデータベースを利用する場合の注意点"><meta property="og:description" content="セッション情報の格納先をデータベースにした場合で、かつ、カスタムセッションを利用している場合の注意点。"><meta property="og:type" content="article"><meta property="og:url" content="https://mizu.dev/posts/2011/cakephp_%E3%82%AB%E3%82%B9%E3%82%BF%E3%83%A0%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%A7%E3%83%87%E3%83%BC%E3%82%BF%E3%83%99%E3%83%BC%E3%82%B9%E3%82%92%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B%E5%A0%B4%E5%90%88%E3%81%AE%E6%B3%A8%E6%84%8F%E7%82%B9/"><meta property="og:image" content="https://mizu.dev/icon.png"><meta property="article:published_time" content="2011-09-06T00:00:00+09:00"><meta property="article:modified_time" content="2011-09-06T00:00:00+09:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://mizu.dev/icon.png"><meta name=twitter:title content="CakePHP カスタムセッションでデータベースを利用する場合の注意点"><meta name=twitter:description content="セッション情報の格納先をデータベースにした場合で、かつ、カスタムセッションを利用している場合の注意点。"><meta itemprop=name content><meta itemprop=description content><link rel=stylesheet href=https://mizu.dev/css/style.css><link rel=stylesheet href=/mizu.css></head><body><header id=navigation class=p-navigation><div class=p-navigation__row><div class=p-navigation__banner><div class=p-navigation__logo><a class="p-navigation__link u-vertically-center p-link--logo" href=https://mizu.dev/>みず ねっとわーくさーびす</a></div><a href=#navigation class=p-navigation__toggle--open title=menu><i class=p-icon--menu></i></a><a href=#navigation-closed class=p-navigation__toggle--close title="close menu"><i class=p-icon--close></i></a></div><nav class=p-navigation__nav><span class=u-off-screen><a href=#main-content>Jump to main content</a></span><ul class=p-navigation__links role=menu><li class=p-navigation__link role=menuitem><a href=/about>About</a></li><li class=p-navigation__link role=menuitem><a href=/tags>Tags</a></li></ul><form class=p-search-box action=https://www.google.com/search target=_blank><input type=search class=p-search-box__input name=q placeholder=Search required aria-label=Query>
<input type=hidden name=sitesearch value=https://mizu.dev/>
<button type=reset class=p-search-box__reset alt=reset aria-label=Reset>
<i class=p-icon--close></i></button>
<button type=submit class=p-search-box__button alt=search aria-label=Search>
<i class=p-icon--search></i></button></form></nav></div></header><div id=main-content><header class="p-strip page-banner"><div class=row><h1>CakePHP カスタムセッションでデータベースを利用する場合の注意点</h1></div><div class=row><div class=col-8><div class=p-media-object><div class=p-media-object__details><p class=p-media-object__content><span class=u-capitalized>on</span>
2011-09-06</p></div></div></div><div class="col-4 col--share-links"><ul class="p-inline-list-icons p-inline-list-icons--share-links u-no-padding--left u-no-margin--left u-unselectable"><li class=p-inline-list__item><i class=p-icon--share></i></li><li class=p-inline-list__item><a class=p-icon--twitter title="Share on Twitter" target=_blank rel=noreferrer href="http://twitter.com/share?text=CakePHP%20%e3%82%ab%e3%82%b9%e3%82%bf%e3%83%a0%e3%82%bb%e3%83%83%e3%82%b7%e3%83%a7%e3%83%b3%e3%81%a7%e3%83%87%e3%83%bc%e3%82%bf%e3%83%99%e3%83%bc%e3%82%b9%e3%82%92%e5%88%a9%e7%94%a8%e3%81%99%e3%82%8b%e5%a0%b4%e5%90%88%e3%81%ae%e6%b3%a8%e6%84%8f%e7%82%b9&url=https%3a%2f%2fmizu.dev%2fposts%2f2011%2fcakephp_%25E3%2582%25AB%25E3%2582%25B9%25E3%2582%25BF%25E3%2583%25A0%25E3%2582%25BB%25E3%2583%2583%25E3%2582%25B7%25E3%2583%25A7%25E3%2583%25B3%25E3%2581%25A7%25E3%2583%2587%25E3%2583%25BC%25E3%2582%25BF%25E3%2583%2599%25E3%2583%25BC%25E3%2582%25B9%25E3%2582%2592%25E5%2588%25A9%25E7%2594%25A8%25E3%2581%2599%25E3%2582%258B%25E5%25A0%25B4%25E5%2590%2588%25E3%2581%25AE%25E6%25B3%25A8%25E6%2584%258F%25E7%2582%25B9%2f">Twitter</a></li></ul></div></div><div class=row><div class=col-12><a href=https://mizu.dev/tags/%E9%96%8B%E7%99%BA/>#開発</a>&ensp;
<a href=https://mizu.dev/tags/cakephp/>#CakePHP</a>&ensp;</div></div></header><section class="p-strip is-shallow"><main class="row post-content"><p>セッション情報の格納先をデータベースにした場合で、かつ、カスタムセッションを利用している場合の注意点。</p><p><code>Configure::write('Session.save', 'database');</code> に戻すこと。</p><p>でないと、セッション情報を書き込み時に、データベースの接続が切れて、セッション情報が書き込めなくなる現象がおきる。</p><p>原因は、ConnectionManager のデストラクタで Session.save が database のときだけ session_write_close() を実行するから。</p><p>ちなみに、カスタムセッションとは、<code>Configure::write('Session.save', 'custom');</code> などにして、php、cake、database、cache にしていない場合のことです。</p><p>CakePHP (v1.3.11) で確認。</p></main></section><footer class="p-strip is-wrapper"><div class=row><div class=p-article-pagination><a class=p-article-pagination__link--previous href=https://mizu.dev/posts/2011/%E3%82%B3%E3%83%B3%E3%83%86%E3%83%B3%E3%83%84%E3%81%AE%E3%82%B5%E3%82%A4%E3%82%BA%E3%81%AB%E5%BF%9C%E3%81%98%E3%81%A6%E3%82%A2%E3%82%A4%E3%83%86%E3%83%A0%E6%95%B0%E3%82%92%E5%A4%89%E6%9B%B4%E3%81%99%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E5%A4%89%E6%9B%B4/><span class=p-article-pagination__label>Previous</span>
<span class=p-article-pagination__title>コンテンツのサイズに応じて、アイテム数を変更するように変更</span></a>
<a class=p-article-pagination__link--next href=https://mizu.dev/posts/2011/%E3%82%BB%E3%83%96%E3%83%B3%E3%82%B9%E3%83%89%E3%83%A9%E3%82%B4%E3%83%B32020_%E3%82%AF%E3%83%AA%E3%82%A2%E3%83%BC/><span class=p-article-pagination__label>Next</span>
<span class=p-article-pagination__title>セブンスドラゴン2020 クリアー！</span></a></div></div></footer></div><footer class="p-strip is-shallow page-footer"><div class=row><div class="col-12 u-align--center"><p>© 2021 みず ねっとわーくさーびす</p></div></div></footer><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-315446-3','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></body></html>